\lstset{
language=[Sharp]C, % Grundsprache ist C und Dialekt ist Sharp (C#)
captionpos=b, % Beschriftung ist unterhalb
frame=lines, % Oberhalb und unterhalb des Listings ist eine Linie
basicstyle=\ttfamily\scriptsize, % Schriftart
keywordstyle=\color{blue}, % Farbe für die Keywords wie public, void, object u.s.w.
commentstyle=\color{dunkelgruen}, % Farbe der Kommentare
stringstyle=\color{red}, % Farbe der Zeichenketten
numbers=left, % Zeilennummern links vom Code
numberstyle=\tiny, % kleine Zeilennummern
numbersep=5pt,
breaklines=true, % Wordwrap a.k.a. Zeilenumbruch aktiviert
showstringspaces=false,
% emph legt Farben für bestimmte Wörter manuell fest
emph={[2]ActivityBaseML,Wait,NormalML,DesignerProperties,EntityRoutingEventArgs,EntityEnteringEventArgs,EntityLeavingEventArgs,CustomEntity,Entity,Browsable,FrameworkPropertyMetadata,ActivityBase,DependencyProperty,Simulation,NestedClassSimulationLogic,InConnectorML,OutConnectorML,StatisticInfoBaseML,ModelLogicBase,DependencyObject,DependencyPropertyChangedEventArgs,ActivityRouteBase,ActivityRouteBaseML,EntityML,XmlnsDefinition,InternalsVisibleTo,CategoryAttribute,DisplayName,DesignTimeVisible,AttributeTableBuilder,FeatureAttribute,Generator,GeneratorInitializer,AttributeTable,IProvideAttributeTable,RegisterMetadata,ModelItem,PropertyNames,UniformDouble,ModelFactory,TypeIdentifier,PropertyIdentifier,ProbabilityDistributionBase,DistributionBase,UsesItemPolicy,SelectionPolicy,SimulationContainerAdornerProvider,AdornerProvider,GeneratorCategoryEditor,ExitBaseCategoryEditor,GeneralCategoryEditor,EditorAttribute},
emphstyle={[2]\color{cyan}},
emph={[1]var,where,from,select,double,bool,int,unsigned,char,true,false,void,value,get,set,assembly},
emphstyle={[1]\color{blue}},
emph={[3]\using,\#define,\#ifdef,\#endif}, emphstyle={[3]\color{blue}}}